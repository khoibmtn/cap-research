# Session Context Snapshot
**Saved:** 2026-02-22T04:45:00+07:00
**Branch:** main
**Last Commit:** 602c939 merge: feat/backup-management - backup system, restore conflict resolution, confirm dialog fix, user manual

## What Was Done This Session
- **Advanced Search Filters (DashboardPage)**: Reorganized filter panel into 4 groups (Hành chính, Cận lâm sàng, Marker & PSI, Kết cục). Added multi-select for Nơi ở, Tình trạng ra viện, Diễn biến. Made Giới tính toggle-based. Light yellow background, bold red count, hint text.
- **Statistics Dashboard (AnalyticsPage)**: Complete rewrite with 3-tab A+C dashboard:
  - Tab 1 "Tổng quan": 20 KPI cards (demographics, PSI, biomarkers, inflammation, outcomes) + PSI pie + Outcome donut + Tiền sử bar
  - Tab 2 "Vi sinh (MT1)": Top 10 VK bar chart + Kháng sinh đồ S/I/R heatmap table
  - Tab 3 "Biomarker (MT2)": Summary table (Mean±SD, Median Q1-Q3) + Biomarker by PSI bar charts + NLR/PLR/CAR scatter plots + Mortality by PSI stacked bar
- **Bar chart labels**: Added n (%) labels to all bar charts across all tabs
- **New utility**: Created `src/utils/statsHelpers.ts` with mean, sd, median, q1, q3, iqr, pct, frac, psiClass helpers

## Work In Progress
- None — all tasks completed

## Key Files Modified
- `src/pages/AnalyticsPage.tsx` — Full rewrite: 3-tab statistics dashboard
- `src/pages/DashboardPage.tsx` — Advanced search filter reorganization
- `src/utils/statsHelpers.ts` — NEW: Statistical helper functions
- `src/pages/SettingsPage.tsx` — Minor changes from previous session
- `src/services/backupService.ts` — Previous session changes
- `src/services/patientService.ts` — Previous session changes
- `src/services/settingsService.ts` — Previous session changes

## Environment Notes
- Node: v25.2.1
- Firebase project: cap-research-app
- Last deploy: pending this workflow

## Important Context for Next Session
- Statistics dashboard uses Recharts for all charts
- 5 novel biomarkers tracked: sTREM-1, TIMP-1, IL-6, IL-10, IL-17
- PSI scoring determines severity class I-V
- Data structure defined in `src/types/patient.ts`
- Current sample: 9 patients (collecting through 12/2026)
